<html>
<head>
<meta name="viewport" content="width=device-width" />
	<title>SeeClickFix Table</title>
	<script src="https://code.jquery.com/jquery-latest.js" type="text/javascript"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
	<link rel="stylesheet" type="text/css" href="clickfix.css"></link>
	<script type="text/javascript">
		$(document).ready(function () {
			
			var date = new Date().toISOString().slice(0,10);
			$(".title").append("Date: " + moment(date).format('MMMM Do, Y'));
			$.getJSON("https://townofchapelhill.github.io/scf-reconciliation/seeclickfix.json",
            function processData(jsonData) {
                var totalRequests = 0;
                var sumTotal = 0;
                
				$.each(jsonData.issues, function (object, objectData) {
					//console.log(objectData);
					$("table").append("<tr><td>" + objectData.id + "</td><td>" + objectData.questions[2].answer + "</td><td>" + objectData.questions[0].answer + "</td></tr>");
				totalRequests++;
                sumTotal += parseInt(objectData.questions[2].answer);
                
                if(totalRequests === jsonData.issues.length) {
                    $(".number").append("The Total Number of Requests is " + totalRequests);
                    $(".amount").append("The Amount Paid Sum is " + sumTotal + " dollars");
                    }
                    
                });
			});
			
		});
	</script>
</head>
</body>
	<h2 class = "title"></h2>
	<table class = "table">
		<tr>
			<th>Request ID#</th>
			<th>Amount Paid</th>
			<th># of Items</th>
		</tr>
	</table>
     <p class = "number">
    </p>
     <p class = "amount">
     </p>
</body>
</html>
